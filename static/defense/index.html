<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Optimal Throughput Bioinformatics</title>
<meta name="author" content="Ragnar {Groot Koerkamp}"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/theme/white.css" id="theme"/>

<link rel="stylesheet" href="/css/slide.min.css"/>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h1 class="title" style="margin-top:-10%">Optimal Throughput Bioinformatics</h1>
<p class="subtitle" style="color:grey">PhD Defense</p>
<h2 class="author" style="margin:0">Ragnar {Groot Koerkamp}</h2>
<h2 class="date" style="font-size:smaller;font-weight:normal;color:grey">April 10, 2025</h2>
<img src="/ox-hugo/bmilab.svg" style="position:absolute;bottom:6.5%;left:2%;width:30%"></img>
<img src="/ox-hugo/ethz.svg" style="position:absolute;bottom:0%;right:33%;width:30%"></img>
<a href="https://curiouscoding.nl/defense" style="position:absolute;bottom:6.8%;right:1%;width:30%;color:grey;font-size:smaller">curiouscoding.nl/defense</a>
</section>
<script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>


<div id="orgeab746c" class="figure">
<p><img src="ethz.svg" alt="ethz.svg" class="org-svg" style="display:none" />
</p>
</div>

<div id="org3278950" class="figure">
<p><img src="bmilab.svg" alt="bmilab.svg" class="org-svg" style="display:none" />
</p>
</div>
<section id="slide-bioinformatics-1">
<h2 id="bioinformatics-1">What is <span class="underline">bio</span>​informatics?</h2>
</section>
<section id="slide-dna">
<h3 id="dna">For today: DNA</h3>

<div id="org7e97c72" class="figure">
<p><img src="/ox-hugo/dna.gif" alt="dna.gif" class="large" style="height:1000px" />
</p>
</div>

<p class="full-caption attribution">
Zephyris, CC BY-SA 3.0 <a href="https://commons.wikimedia.org/w/index.php?curid=2118354" class="full-caption attribution">Wikipedia</a>
</p>
</section>
<section id="slide-dna-chromosome">
<h3 id="dna-chromosome">Also DNA</h3>

<div id="org1f362ce" class="figure">
<p><img src="/ox-hugo/chromosomes.png" alt="chromosomes.png" class="large" />
</p>
</div>

<p class="full-caption">
Human chromosomes
</p>
</section>
<section id="slide-dna-alph">
<h3 id="dna-alph">DNA, according to me</h3>
<p style="font-size:400px;text-align:center;position:relative;top:10%">
A C G T
</p>

<p style="font-size:200px;text-align:center;word-spacing:70px;padding-top:70px;color:lightgrey">
00 01 10 11
</p>
</section>
<section id="slide-virus">
<h3 id="virus">Covid</h3>

<div id="orgd80bf6e" class="figure">
<p><img src="/ox-hugo/covid-virus.png" alt="covid-virus.png" class="full" />
</p>
</div>

<p class="full-caption">
A virus: SARS-CoV-2, aka COVID-19
</p>

<aside class="notes">
<p>
covid vs sars-cov-2
</p>

</aside>
</section>
<section id="slide-bioinformatics-2">
<h2 id="bioinformatics-2">Why bio​<span class="underline">informatics</span>?</h2>
</section>
<section id="slide-floppy">
<h3 id="floppy">1970-2000: Floppy disks - MB - Bacteria</h3>

<div id="org3ac0b2b" class="figure">
<p><img src="/ox-hugo/floppy.jpg" alt="floppy.jpg" class="large" style="max-height:750px;max-width:880px;left:25%" />
</p>
</div>

<p class="full-caption attribution left">
Floppy
</p>


<div id="org0c5e9ea" class="figure">
<p><img src="/ox-hugo/e-coli.jpg" alt="e-coli.jpg" class="large" style="max-height:750px;max-width:880px;left:75%" />
</p>
</div>

<p class="full-caption attribution">
<i>E. coli</i> bacteria (1997)
</p>
</section>
<section id="slide-usb">
<h3 id="usb">2000-2020: USB stick - GB - Human Genome</h3>

<div id="orgc2ea063" class="figure">
<p><img src="/ox-hugo/usb-stick.jpg" alt="usb-stick.jpg" class="large" style="max-height:750px;max-width:880px;left:25%" />
</p>
</div>

<p class="full-caption attribution left">
USB stick
</p>


<div id="orgd1d9a43" class="figure">
<p><img src="/ox-hugo/chromosomes.png" alt="chromosomes.png" class="large" style="max-height:750px;max-width:880px;left:75%" />
</p>
</div>

<p class="full-caption attribution">
Human genome (2001)
</p>
</section>
<section id="slide-harddrive">
<h3 id="harddrive">2010-2020: Hard Drive - TB - RefSeq</h3>

<div id="orgf19956f" class="figure">
<p><img src="/ox-hugo/harddrive.jpg" alt="harddrive.jpg" class="large" style="height:750px;max-height:1080px;max-width:1920px;left:20%" />
</p>
</div>

<p class="full-caption attribution left">
Hard drive
</p>


<div id="org12e84e4" class="figure">
<p><img src="/ox-hugo/refseq.png" alt="refseq.png" class="large" style="max-height:750px;max-width:1150px;left:70%;top:25%" />
</p>
</div>


<div id="org59bd281" class="figure">
<p><img src="/ox-hugo/animals.png" alt="animals.png" class="large" style="max-height:550px;max-width:1150px;left:70%;top:65%" />
</p>
</div>

<p class="full-caption attribution">
RefSeq
</p>
</section>
<section id="slide-datacenter">
<h3 id="datacenter">2025: Data Center - PB - SRA</h3>

<div id="org8c9fd01" class="figure">
<p><img src="/ox-hugo/datacenter.jpg" alt="datacenter.jpg" class="large" style="width:960;pxmax-height:750px;left:20%" />
</p>
</div>

<p class="full-caption attribution left">
Data Center<br />
PhonlamaiPhoto | istockphoto.com
</p>


<div id="org54922bc" class="figure">
<p><img src="/ox-hugo/sra-marked.png" alt="sra-marked.png" class="large" style="height:850px;max-height:1000px;max-width:1400px;left:70%" />
</p>
</div>

<p class="full-caption attribution">
Growth of <a href="https://www.ncbi.nlm.nih.gov/sra/docs/sragrowth/" class="full-caption attribution">SRA</a>
</p>
</section>
<section id="slide-fast">
<h2 id="fast">Goal:<br/> <span class="underline">Fast</span> code</h2>
</section>
<section id="slide-throughput">
<h2 id="throughput">Goal:<br/> High <span class="underline">throughput</span> code</h2>
</section>
<section id="slide-optimal">
<h2 id="optimal">Goal:<br/> <span class="underline">Optimal</span> throughput code</h2>
</section>
<section id="slide-complexity">
<h3 id="complexity">What is high troughput code?</h3>
<ol>
<li class="fragment appear"><i>Complexity</i>
<ul>
<li><p>
<i>Few</i> operations:
</p>

<p style="text-align:center;width:1920px;margin:0em -3em">
\(\quad O(n^2)\quad\longleftrightarrow\quad O(n)\)
</p></li>

</ul></li>
<li class="fragment appear"><i>Efficiency</i>
<ul>
<li><p>
<i>Fast</i> operations:
</p>

<p style="text-align:center;width:1920px;margin:0em -3em;font-size:smaller">
memory read, 100 ns \(\quad\longleftrightarrow\quad\) 0.1 ns, addition
</p></li>

</ul></li>
<li class="fragment appear"><i>Implementation</i>
<ul>
<li><p>
<i>Parallel</i> operations:
</p>

<p style="text-align:center;width:1920px;margin:0em -3em;font-size:smaller">
SIMD, instruction-level parallelism
</p></li>

</ul></li>

</ol>
</section>
<section id="slide-publications">
<h2 id="publications">Papers</h2>
<p style="position:fixed;right:10px;top:11%;font-size:40px">
Part 1: Pairwise Alignment
</p>

<p style="position:fixed;right:10px;top:31%;font-size:40px">
Part 2: Minimizers
</p>

<p style="position:fixed;right:10px;top:61%;font-size:40px">
Part 3: Optimal Throughput
</p>

<p style="position:fixed;right:10px;top:81%;font-size:40px">
Additional
</p>

<ul>
<li>[1] <b>A*PA</b>: <i>Exact Global Alignment Using A* with Chaining Seed Heuristic and Match Pruning.</i><br />
RGK and Pesho Ivanov, Bioinformatics 2024.</li>
<li>[2] <i><b>A*PA2</b>: Up to 19x Faster Exact Global Alignment.</i><br />
RGK. WABI 2024.</li>

</ul>
<hr />
<ul>
<li>[3] <i>The <b>Mod-Minimizer</b>: A Simple and Efficient Sampling Algorithm for Long k-mers.</i><br />
RGK and Giulio Ermanno Pibiri. WABI 2024.</li>
<li>[4] <i>Forward Sampling Scheme <b>Density Lower Bound</b>.</i><br />
Bryce Kille, RGK, et al. Bioinformatics 2024.</li>
<li>[5] <i>The <b>Open-Closed Mod-Minimizer</b> Algorithm.</i><br />
RGK, Daniel Liu, and Giulio Ermanno Pibiri. AMB 2025.</li>

</ul>
<hr />
<ul>
<li>[6] <i><b>SimdMinimizers</b>: Computing Random Minimizers, Fast.</i><br />
RGK and Igor Martayan. SEA 2025.</li>
<li>[7] <i><b>PtrHash</b>: Minimal Perfect Hashing at RAM Throughput.</i><br />
RGK. SEA 2025.</li>

</ul>
<hr />
<ul>
<li>[8] <i><b>U-index</b>: A Universal Indexing Framework for Matching Long Patterns.</i><br />
Lorraine Ayad, Gabriele Fici, RGK, Rob Patro, Giulio Ermanno Pibiri, and Solon Pissis. SEA 2025.</li>

</ul>

<aside class="notes">
<p>
Throughput is not in presentation, but in part 3 of the thesis
</p>

</aside>
</section>
<section id="slide-pairwise-alignment-title">
<h2 id="pairwise-alignment-title">Problem 1: Pairwise Alignment</h2>
</section>
<section id="slide-covid-alpha">
<h3 id="covid-alpha">Covid &#x2013; \(\alpha\), December 2020</h3>

<div id="org6bffc8a" class="figure">
<p><img src="/ox-hugo/covid-alpha-highlight.png" alt="covid-alpha-highlight.png" class="full" />
</p>
</div>

<p class="full-caption">
Sars-CoV-2, alpha variant, December 2020
</p>
</section>
<section id="slide-covid-omicron">
<h3 id="covid-omicron">Covid &#x2013; \(\omicron\), December 2021</h3>

<div id="org09e8366" class="figure">
<p><img src="/ox-hugo/covid-omicron-highlight-marked.png" alt="covid-omicron-highlight-marked.png" class="full" />
</p>
</div>

<p class="full-caption">
Sars-CoV-2, omicron variant, December 2021
</p>
</section>
<section id="slide-pairwise-alignment">
<h3 id="pairwise-alignment">Pairwise alignment</h3>
<ul>
<li>Find the mutations between two sequences</li>

</ul>


<div id="orgf9d18b8" class="figure">
<p><img src="/ox-hugo/edit-graph.svg" alt="edit-graph.svg" class="large" style="width:1500px;padding-top:100px" />
</p>
</div>
</section>
<section id="slide-dp-1">
<h3 id="dp-1">Dynamic programming</h3>

<div id="org56fcdba" class="figure">
<p><img src="/ox-hugo/dp-1.svg" alt="dp-1.svg" class="large" style="height:800px" />
</p>
</div>
</section>
<section id="slide-dp-2">
<h3 id="dp-2">Dynamic programming</h3>

<div id="org1324b66" class="figure">
<p><img src="/ox-hugo/dp-2.svg" alt="dp-2.svg" class="large" style="height:800px" />
</p>
</div>
</section>
<section id="slide-dp-3">
<h3 id="dp-3">Dynamic programming</h3>

<div id="org6b8f1d0" class="figure">
<p><img src="/ox-hugo/dp-3.svg" alt="dp-3.svg" class="large" style="height:800px" />
</p>
</div>
</section>
<section id="slide-dp-4">
<h3 id="dp-4">Dynamic programming</h3>

<div id="orgf7f1d8f" class="figure">
<p><img src="/ox-hugo/dp-4.svg" alt="dp-4.svg" class="large" style="height:800px" />
</p>
</div>
</section>
<section id="slide-dp-5">
<h3 id="dp-5">Dynamic programming</h3>

<div id="org851ac40" class="figure">
<p><img src="/ox-hugo/dp-5.svg" alt="dp-5.svg" class="large" style="height:800px" />
</p>
</div>
</section>
<section id="slide-nw">
<h3 id="nw">Needleman-Wunsch &#x2013; Quadratic \(O(n^2)\)</h3>

<div id="org1d40b52" class="figure">
<p><img src="/ox-hugo/alg-nw.svg" alt="alg-nw.svg" class="large" style="height:800px;left:25%" />
</p>
</div>


<div id="org71f56f8" class="figure">
<p><img src="/ox-hugo/0_nw.gif" alt="0_nw.gif" class="large" style="height:800px;left:75%" />
</p>
</div>
</section>
<section id="slide-dijkstra">
<h3 id="dijkstra">Dijkstra &#x2013; \(O(ns)\)</h3>

<div id="org8e013fb" class="figure">
<p><img src="/ox-hugo/alg-dijkstra.svg" alt="alg-dijkstra.svg" class="large" style="height:800px;left:25%" />
</p>
</div>


<div id="orgca4ebff" class="figure">
<p><img src="/ox-hugo/2_dijkstra.gif" alt="2_dijkstra.gif" class="large" style="height:800px;left:75%" />
</p>
</div>

<aside class="notes">
<p>
Fewer states is better
</p>

</aside>
</section>
<section id="slide-dt">
<h3 id="dt">Diagonal transition &#x2013; \(O(n + s^2)\)</h3>

<div id="org993bb8e" class="figure">
<p><img src="/ox-hugo/alg-dt.svg" alt="alg-dt.svg" class="large" style="height:800px;left:25%" />
</p>
</div>


<div id="org7ee4b0b" class="figure">
<p><img src="/ox-hugo/3_diagonal_transition.gif" alt="3_diagonal_transition.gif" class="large" style="height:800px;left:75%" />
</p>
</div>

<aside class="notes">
<p>
Complexity is in expectation
</p>

</aside>
</section>
<section id="slide-astarpa">
<h3 id="astarpa">A*PA\({}^{1}\) &#x2013; near-linear, \(3\times\) faster on similar seqs</h3>

<div id="orgb92ed76" class="figure">
<p><img src="/ox-hugo/alg-astarpa.svg" alt="alg-astarpa.svg" class="large" style="height:800px;left:25%" />
</p>
</div>


<div id="orga3d8d8f" class="figure">
<p><img src="/ox-hugo/5_astarpa.gif" alt="5_astarpa.gif" class="large" style="height:800px;left:75%" />
</p>
</div>


<p class="citation">
[1] <i>Exact Global Alignment Using A* with Chaining Seed Heuristic and Match Pruning.</i><br />
RGK and Pesho Ivanov, Bioinformatics 2024.
</p>

<aside class="notes">
<p>
Worst-case vs avg-case complexity
</p>

</aside>
</section>
<section id="slide-astarpa-bad">
<h3 id="astarpa-bad">A*PA\({}^{1}\) &#x2013; not quite linear</h3>

<div id="org665acc0" class="figure">
<p><img src="/ox-hugo/5_astarpa_noisy.gif" alt="5_astarpa_noisy.gif" class="large" style="height:800px;left:50%" />
</p>
</div>

<p class="citation">
[1] <i>Exact Global Alignment Using A* with Chaining Seed Heuristic and Match Pruning.</i><br />
RGK and Pesho Ivanov, Bioinformatics 2024.
</p>
</section>
<section id="slide-astarpa-conclusion">
<h2 id="astarpa-conclusion">A*PA: Great complexity &#x2013; terrible efficiency</h2>
</section>
<section id="slide-doubling">
<h3 id="doubling">Band Doubling &#x2013; \(O(ns)\)</h3>

<div id="orgd715acd" class="figure">
<p><img src="/ox-hugo/alg-doubling.svg" alt="alg-doubling.svg" class="large" style="height:800px;left:25%" />
</p>
</div>


<div id="orgc5628ec" class="figure">
<p><img src="/ox-hugo/1_edlib.gif" alt="1_edlib.gif" class="large" style="height:800px;left:75%" />
</p>
</div>
</section>
<section id="slide-astarpa2">
<h3 id="astarpa2">A*PA2\({}^{2}\) &#x2013; good efficiency: up to \(19\times\) faster</h3>

<div id="orge4de1c1" class="figure">
<p><img src="/ox-hugo/alg-astarpa2.svg" alt="alg-astarpa2.svg" class="large" style="height:800px;left:25%" />
</p>
</div>


<div id="org55520ae" class="figure">
<p><img src="/ox-hugo/6_astarpa2.gif" alt="6_astarpa2.gif" class="large" style="height:800px;left:75%" />
</p>
</div>

<p class="citation">
[2] <i>A*PA2: Up to 19x Faster Exact Global Alignment.</i><br />
RGK. WABI 2024.
</p>

<aside class="notes">
<p>
mention throughput
</p>

</aside>
</section>
<section id="slide-minimizers">
<h2 id="minimizers">Problem 2: Minimizers &#x2013; lossy compression</h2>
</section>
<section id="slide-lossy-1">
<h3 id="lossy-1">Lossy compression</h3>

<div id="orgaffce02" class="figure">
<p><img src="/ox-hugo/100.png" alt="100.png" class="full" />
</p>
</div>

<p class="full-caption">
original
</p>
</section>
<section id="slide-lossy-2">
<h3 id="lossy-2">Lossy compression</h3>

<div id="org1d2455f" class="figure">
<p><img src="/ox-hugo/50.png" alt="50.png" class="full" />
</p>
</div>

<p class="full-caption">
50%
</p>
</section>
<section id="slide-lossy-3">
<h3 id="lossy-3">Lossy compression</h3>

<div id="org8c22130" class="figure">
<p><img src="/ox-hugo/25.png" alt="25.png" class="full" />
</p>
</div>

<p class="full-caption">
25%
</p>
</section>
<section id="slide-lossy-4">
<h3 id="lossy-4">Lossy compression</h3>

<div id="org27d36e4" class="figure">
<p><img src="/ox-hugo/12.png" alt="12.png" class="full" />
</p>
</div>

<p class="full-caption">
12%
</p>
</section>
<section id="slide-lossy-5">
<h3 id="lossy-5">Lossy compression</h3>

<div id="org5064966" class="figure">
<p><img src="/ox-hugo/6.png" alt="6.png" class="full" />
</p>
</div>

<p class="full-caption">
6%
</p>
</section>
<section id="slide-sampling-kmers-1">
<h3 id="sampling-kmers-1">Sampling k-mers</h3>

<div id="orgad768c2" class="figure">
<p><img src="/ox-hugo/10-1000.png" alt="10-1000.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=10\), \(w=1000\)
</p>

<aside class="notes">
<p>
w=1000 looses too much information
</p>

</aside>
</section>
<section id="slide-minimizer-dfn">
<h3 id="minimizer-dfn">Minimizer definition</h3>

<div id="org0198be9" class="figure">
<p><img src="/ox-hugo/mini-dfn.svg" alt="mini-dfn.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>

<p style="position:absolute;top:30%;right:10px;font-size:45px">
\(k\)-mer size: \(k=3\) <br />
<i>Window guarantee</i>: \(w=4\) <br />
Length \(w+k-1=6\) window of \(w\) \(k\)-mers <br />
<br />
Minimizer scheme:
\[
f: \Sigma^{w+k-1} \mapsto \{0, 1, 2, \dots, w-1\}.
\]
<br />
Used for compression and hashing.
</p>

<aside class="notes">
<p>
Find f that minimizes density
</p>

<p>
leftmost vs alphabetical
</p>

<p>
usage in
</p>

</aside>
</section>
<section id="slide-minimizer-1">
<h3 id="minimizer-1">Minimizer example</h3>

<div id="org1487bf6" class="figure">
<p><img src="/ox-hugo/mini-1.svg" alt="mini-1.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-minimizer-2">
<h3 id="minimizer-2">Minimizer example</h3>

<div id="org0799bcf" class="figure">
<p><img src="/ox-hugo/mini-2.svg" alt="mini-2.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-minimizer-3">
<h3 id="minimizer-3">Minimizer example</h3>

<div id="orgff269ef" class="figure">
<p><img src="/ox-hugo/mini-3.svg" alt="mini-3.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-minimizer-4">
<h3 id="minimizer-4">Minimizer example</h3>

<div id="org76ea041" class="figure">
<p><img src="/ox-hugo/mini-4.svg" alt="mini-4.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-minimizer-5">
<h3 id="minimizer-5">Minimizer example</h3>

<div id="orgddf3314" class="figure">
<p><img src="/ox-hugo/mini-5.svg" alt="mini-5.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-minimizer-6">
<h3 id="minimizer-6">Minimizer example</h3>

<div id="orge75c8fe" class="figure">
<p><img src="/ox-hugo/mini-6.svg" alt="mini-6.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-minimizer-dens">
<h3 id="minimizer-dens">Minimizer density</h3>

<div id="org6bb0795" class="figure">
<p><img src="/ox-hugo/mini-density.svg" alt="mini-density.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>

<p style="position:absolute;top:45%;left:300px;text-align:center">
Density: expected fraction of sampled \(k\)-mers.<br />
Here: \(3/9=0.33\)
</p>
</section>
<section id="slide-sampling-kmers-2">
<h3 id="sampling-kmers-2">Sampling k-mers</h3>

<div id="org50e86ad" class="figure">
<p><img src="/ox-hugo/10-500.png" alt="10-500.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=10\), \(w=500\)
</p>
</section>
<section id="slide-sampling-kmers-3">
<h3 id="sampling-kmers-3">Sampling k-mers</h3>

<div id="org4e17ca2" class="figure">
<p><img src="/ox-hugo/10-250.png" alt="10-250.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=10\), \(w=250\)
</p>
</section>
<section id="slide-sampling-kmers-4">
<h3 id="sampling-kmers-4">Sampling k-mers</h3>

<div id="orgf0e5cc4" class="figure">
<p><img src="/ox-hugo/10-100.png" alt="10-100.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=10\), \(w=100\)
</p>
</section>
<section id="slide-sampling-kmers-5">
<h3 id="sampling-kmers-5">Sampling k-mers</h3>

<div id="org81376e8" class="figure">
<p><img src="/ox-hugo/10-50.png" alt="10-50.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=10\), \(w=50\)
</p>
</section>
<section id="slide-sampling-kmers-6">
<h3 id="sampling-kmers-6">Sampling k-mers</h3>

<div id="org90992be" class="figure">
<p><img src="/ox-hugo/10-25.png" alt="10-25.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=10\), \(w=25\)
</p>
</section>
<section id="slide-sampling-kmers-7">
<h3 id="sampling-kmers-7">Sampling k-mers</h3>

<div id="org389fd4d" class="figure">
<p><img src="/ox-hugo/10-100.png" alt="10-100.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=10\), \(w=100\)
</p>
</section>
<section id="slide-sampling-kmers-8">
<h3 id="sampling-kmers-8">Sampling k-mers</h3>

<div id="org4655c9b" class="figure">
<p><img src="/ox-hugo/11-100.png" alt="11-100.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=11\), \(w=100\)
</p>
</section>
<section id="slide-sampling-kmers-9">
<h3 id="sampling-kmers-9">Sampling k-mers</h3>

<div id="org7a1ebc9" class="figure">
<p><img src="/ox-hugo/12-100.png" alt="12-100.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=12\), \(w=100\)
</p>
</section>
<section id="slide-sampling-kmers-10">
<h3 id="sampling-kmers-10">Sampling k-mers</h3>

<div id="org8910bc5" class="figure">
<p><img src="/ox-hugo/20-100.png" alt="20-100.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=20\), \(w=100\)
</p>
</section>
<section id="slide-sampling-kmers-11">
<h3 id="sampling-kmers-11">Sampling k-mers</h3>

<div id="org8ae8041" class="figure">
<p><img src="/ox-hugo/30-100.png" alt="30-100.png" class="full" />
</p>
</div>

<p class="full-caption" style="background-color:white">
\(k=30\), \(w=100\)
</p>
</section>
<section id="slide-mini-goal">
<h2 id="mini-goal">Goal: Minimize the number of sampled \(k\)-mers</h2>
</section>
<section id="slide-density-old">
<h3 id="density-old">Density plots &#x2013; before (\(w=24\))</h3>

<div id="orge81f44d" class="figure">
<p><img src="/ox-hugo/defense-1-before.svg" alt="defense-1-before.svg" class="plot" />
</p>
</div>
</section>
<section id="slide-density-mod">
<h3 id="density-mod">The Mod-Minimizer\({}^{3}\)</h3>

<div id="org384b243" class="figure">
<p><img src="/ox-hugo/defense-2-mod.svg" alt="defense-2-mod.svg" class="plot" />
</p>
</div>

<p class="citation">
[3] <i>The Mod-Minimizer: A Simple and Efficient Sampling Algorithm for Long k-mers.</i>
RGK and Giulio Ermanno Pibiri. WABI 2024.
</p>
</section>
<section id="slide-density-lb">
<h3 id="density-lb">A Near-Tight Lower Bound\({}^{4}\)</h3>

<div id="orgfac9a5c" class="figure">
<p><img src="/ox-hugo/defense-3-lb.svg" alt="defense-3-lb.svg" class="plot" />
</p>
</div>

<p class="citation">
[4] <i>Forward sampling scheme density lower bound.</i>
Bryce Kille, RGK, et al. Bioinformatics 2024.
</p>
</section>
<section id="slide-density-new">
<h3 id="density-new">Near-optimal schemes for small \(k\)</h3>

<div id="orgfd58211" class="figure">
<p><img src="/ox-hugo/defense-4-small-k.svg" alt="defense-4-small-k.svg" class="plot" />
</p>
</div>

<p class="citation">
(Unpublished)
</p>
</section>
<section id="slide-density-new">
<h3 id="density-new">Extended mod-minimizer\({}^{5}\)</h3>

<div id="orgb7569cd" class="figure">
<p><img src="/ox-hugo/defense-5-ext-mod.svg" alt="defense-5-ext-mod.svg" class="plot" />
</p>
</div>

<p class="citation">
[5] <i>The Open-closed mod-minimizer Algorithm.</i>
RGK, Daniel Liu, and Giulio Ermanno Pibiri. AMB 2025.
</p>
</section>
<section id="slide-lb-proof">
<h3 id="lb-proof">Proving The Lower Bound</h3>
<ul>
<li><p>
Suppose \(k=1\), and consider a <i>cycle</i> of \(w+1\) characters. <br />
Eg for \(w=4\):
</p>

<p style="text-align:center">
ABCDEABCDEABCDE
</p></li>

<li><p>
Suppose we only sample 1 character:
</p>

<p style="text-align:center">
AB​<span class="underline">C</span>​DEAB​<span class="underline">C</span>​DEAB​<span class="underline">C</span>​DE
</p>

<p>
The distance between samples is \(5 > w\)!
</p></li>

<li>Thus, we need at least two samples.</li>
<li>Conclusion: the density is at least \(2/(w+1)\).</li>

</ul>
</section>
<section id="slide-conclusion">
<h3 id="conclusion">Conclusion: high troughput code matters!</h3>
<ol>
<li class="fragment appear"><i>Complexity</i>
<ul>
<li><p>
<i>Few</i> operations:
</p>

<p style="text-align:center;width:1920px;margin:0em -3em">
A*PA: \(\quad O(n^2)\quad \mapsto\quad \ ``O(n)\text{''}\)
</p>

<p style="text-align:center;width:1920px;margin:0em -3em;padding-top:0.5em">
Provably near-optimal minimizer schemes.
</p></li>

</ul></li>
<li class="fragment appear"><i>Efficiency</i>
<ul>
<li><p>
<i>Fast</i> operations:
</p>

<p style="text-align:center;width:1920px;margin:0em -3em;font-size:smaller">
A*PA2 is up to 500x more efficient than A*PA; up to 19x faster than other methods.
</p></li>

</ul></li>
<li class="fragment appear"><i>Implementation</i>
<ul>
<li><p>
<i>Parallel</i> operations:
</p>

<p style="text-align:center;width:1920px;margin:0em -3em;font-size:smaller">
A*PA2 uses SIMD and instruction-level parallelism.
</p></li>

</ul></li>

</ol>
</section>
<section id="slide-orgf6e2709">
<h2 id="orgf6e2709">Outlook</h2>
<ul>
<li>Optimize all the code.</li>
<li>Minimizers are not yet a fully solved problem.</li>
<li>Proving optimality is hard.</li>

</ul>
</section>
<section id="slide-thanks">
<h2 id="thanks">Thanks!</h2>
</section>
<section id="slide-propositions">
<h2 id="propositions">Propositions</h2>
<ol>
<li>Complexity theory&rsquo;s days are numbered.</li>
<li>\(\log \log n \leq 6\)</li>
<li>Succinct data structures are overrated.</li>
<li>There is beauty in mathematical perfection.</li>
<li>Too many PhDs are wasted shaving of small factors of complexities that will
never be practical.</li>
<li>If a paper starts with &ldquo;faster methods are needed&rdquo;, it must talk about the implementation.</li>
<li>Fast code must exploit assumptions on the input.</li>
<li>Fast code puts requirements on the input format.</li>
<li>Optimizing ugly code is a waste of time.</li>
<li>Assembly is not scary.</li>

</ol>
</section>
<section id="slide-extra-pa">
<h2 id="extra-pa">Extra: Pairwise alignment</h2>
</section>
<section id="slide-pa-comparison">
<h3 id="pa-comparison">A*PA: comparison</h3>

<div id="org2f7ed6b" class="figure">
<p><img src="/ox-hugo/pa-comparison.png" alt="pa-comparison.png" class="large" style="max-height:900px" />
</p>
</div>
</section>
<section id="slide-heuristics">
<h3 id="heuristics">A*PA heuristics</h3>

<div id="org6460e9a" class="figure">
<p><img src="/ox-hugo/df-heuristics.png" alt="df-heuristics.png" class="large" style="width:100%" />
</p>
</div>
</section>
<section id="slide-astarpa-sh">
<h3 id="astarpa-sh">A*PA: seed heuristic</h3>

<div id="orgf7d910e" class="figure">
<p><img src="/ox-hugo/layers-sh.gif" alt="layers-sh.gif" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-astarpa-gcsh">
<h3 id="astarpa-gcsh">A*PA: gap-chaining seed heuristic</h3>

<div id="org9842c22" class="figure">
<p><img src="/ox-hugo/layers.gif" alt="layers.gif" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-astarpa-contours">
<h3 id="astarpa-contours">A*PA: contours</h3>

<div id="org809f7d6" class="figure">
<p><img src="/ox-hugo/astarpa-contours.png" alt="astarpa-contours.png" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-prepruning">
<h3 id="prepruning">A*PA2: pre-pruning</h3>

<div id="org210fce1" class="figure">
<p><img src="/ox-hugo/df-prepruning.png" alt="df-prepruning.png" class="large" style="width:100%" />
</p>
</div>
</section>
<section id="slide-astarpa2-results-real">
<h3 id="astarpa2-results-real">A*PA2: results (real data)</h3>

<div id="orgf6cb53b" class="figure">
<p><img src="/ox-hugo/real-summary.svg" alt="a.svg" class="large" style="max-width:100%;width:100%" />
</p>
</div>
</section>
<section id="slide-astarpa2-results-synthetic">
<h3 id="astarpa2-results-synthetic">A*PA2: results (synthetic)</h3>

<div id="org15af1d4" class="figure">
<p><img src="/ox-hugo/scaling_n_e0.05.labels.svg" alt="a.svg" class="large" style="width:45%;left:25%" />
</p>
</div>

<div id="org87aa664" class="figure">
<p><img src="/ox-hugo/scaling_e.labels.svg" alt="a.svg" class="large" style="width:45%;left:75%" />
</p>
</div>
</section>
<section id="slide-alignment-modes">
<h3 id="alignment-modes">Alignment modes</h3>

<div id="org2222e95" class="figure">
<p><img src="/ox-hugo/alignment-modes.svg" alt="a.svg" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-cost-models">
<h3 id="cost-models">Cost models</h3>

<div id="orga899a39" class="figure">
<p><img src="/ox-hugo/cost-models.svg" alt="a.svg" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-semi-global">
<h3 id="semi-global">Semi-global variants</h3>

<div id="org817e256" class="figure">
<p><img src="/ox-hugo/dimentions.svg" alt="a.svg" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-text-searching">
<h3 id="text-searching">Text searching</h3>

<div id="org8f60802" class="figure">
<p><img src="/ox-hugo/search.svg" alt="a.svg" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-skip-cost">
<h3 id="skip-cost">Skip-cost</h3>

<div id="org4ddd6f6" class="figure">
<p><img src="/ox-hugo/skip-cost.svg" alt="a.svg" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-skip-cost-2">
<h3 id="skip-cost-2">Skip-cost</h3>

<div id="org44f2fcb" class="figure">
<p><img src="/ox-hugo/skip-cost-plot.svg" alt="a.svg" class="large" style="height:700px;top:40%" />
</p>
</div>

<div id="org6c9623b" class="figure">
<p><img src="/ox-hugo/skip-cost-setup.svg" alt="a.svg" class="large" style="height:215px;top:80%;left:46%" />
</p>
</div>
</section>
<section id="slide-orgf306bfc">
<h3 id="orgf306bfc">Block-computation results</h3>

<div id="orgee1043f" class="figure">
<p><img src="/ox-hugo/search-plot.svg" alt="a.svg" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-semi-global-astarpa">
<h3 id="semi-global-astarpa">Semi-global A*PA</h3>

<div id="org7688b73" class="figure">
<p><img src="/ox-hugo/semi-global.gif" alt="semi-global.gif" class="large" style="width:100%" />
</p>
</div>
</section>
<section id="slide-org6c2ca45">
<h3 id="org6c2ca45">Seed-chain-extend</h3>

<div id="orgf0c70df" class="figure">
<p><img src="/ox-hugo/seed-chain-extend.svg" alt="a.svg" class="large" style="height:900px" />
</p>
</div>
</section>
<section id="slide-pa-table">
<h3 id="pa-table">A*PA: table</h3>

<div id="orgd1b263b" class="figure">
<p><img src="/ox-hugo/table.png" alt="table.png" class="large" style="max-height:900px" />
</p>
</div>
</section>
<section id="slide-extra-mini">
<h2 id="extra-mini">Extra: Minimizers</h2>
</section>
<section id="slide-org9ba6145">
<h3 id="org9ba6145">Minimizer schemes</h3>
<ul>
<li>Lexicographic: choose lexicographic smallest \(k\)-mer</li>
<li>Random mini: choose \(k\)-mer with smallest hash</li>
<li>ABB: choose A, followed by most non-A</li>
<li>ABB+: break ties via random hash</li>
<li>Sus-anchor: choose the position of the smallest unique suffix
<ul>
<li>&ldquo;smallest&rdquo;: where the first character is inverted.</li>

</ul></li>

</ul>
</section>
<section id="slide-orgc4380d2">
<h3 id="orgc4380d2">Large alphabet</h3>

<div id="org80a785e" class="figure">
<p><img src="/ox-hugo/defense-6-large-sigma.svg" alt="defense-6-large-sigma.svg" class="plot" />
</p>
</div>
</section>
<section id="slide-lb">
<h3 id="lb">Lower bound</h3>

<div id="org7f8d9df" class="figure">
<p><img src="/ox-hugo/df-lb-tight.png" alt="df-lb-tight.png" class="large" style="height:85%" />
</p>
</div>
</section>
<section id="slide-modmini">
<h3 id="modmini">Mod-minimizer</h3>

<div id="orgad5d71e" class="figure">
<p><img src="/ox-hugo/modmini.png" alt="modmini.png" class="large" />
</p>
</div>
</section>
<section id="slide-modmini-1">
<h3 id="modmini-1">Mod-minimizer</h3>

<div id="org4297613" class="figure">
<p><img src="/ox-hugo/modmini-1.svg" alt="modmini-1.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-modmini-2">
<h3 id="modmini-2">Mod-minimizer</h3>

<div id="org29eac4d" class="figure">
<p><img src="/ox-hugo/modmini-2.svg" alt="modmini-2.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-modmini-3">
<h3 id="modmini-3">Mod-minimizer</h3>

<div id="org4bf9ed5" class="figure">
<p><img src="/ox-hugo/modmini-3.svg" alt="modmini-3.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-modmini-4">
<h3 id="modmini-4">Mod-minimizer</h3>

<div id="org47b9b77" class="figure">
<p><img src="/ox-hugo/modmini-4.svg" alt="modmini-4.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-modmini-5">
<h3 id="modmini-5">Mod-minimizer</h3>

<div id="orgbb500e1" class="figure">
<p><img src="/ox-hugo/modmini-5.svg" alt="modmini-5.svg" class="large" style="height:80%;top:580px;left:750px" />
</p>
</div>
</section>
<section id="slide-selection">
<h3 id="selection">Selection schemes</h3>

<div id="orgd256977" class="figure">
<p><img src="/ox-hugo/23-scramble.svg" alt="a.png" class="large" style="height:80%" />
</p>
</div>
</section>
<section id="slide-extra-ptrhash">
<h2 id="extra-ptrhash">Extra: PtrHash</h2>
</section>
<section id="slide-ptrhash-overview">
<h3 id="ptrhash-overview">PtrHash: overview</h3>

<div id="org541f416" class="figure">
<p><img src="/ox-hugo/overview.drawio.svg" alt="a.png" class="large" style="height:80%" />
</p>
</div>
</section>
<section id="slide-ptrhash-clef">
<h3 id="ptrhash-clef">PtrHash: Cacheline Elias Fano</h3>

<div id="org34e552e" class="figure">
<p><img src="/ox-hugo/cacheline-ef.drawio.svg" alt="a.png" class="large" style="height:80%" />
</p>
</div>
</section>
<section id="slide-ptrhash-bf">
<h3 id="ptrhash-bf">PtrHash: Bucket Functions</h3>

<div id="org19da04a" class="figure">
<p><img src="/ox-hugo/bucket_fn_stats.svg" alt="a.png" class="large" style="height:80%" />
</p>
</div>
</section>
<section id="slide-ptrhash-construction">
<h3 id="ptrhash-construction">PtrHash: Construction</h3>

<div id="org128175e" class="figure">
<p><img src="/ox-hugo/size.svg" alt="a.png" class="large" style="height:80%" />
</p>
</div>
</section>
<section id="slide-ptrhash-results">
<h3 id="ptrhash-results">PtrHash: Results</h3>

<div id="orga970695" class="figure">
<p><img src="/ox-hugo/ptrhash-results.png" alt="ptrhash-results.png" class="large" style="height:80%" />
</p>
</div>
</section>
<section id="slide-ptrhash-throughput">
<h3 id="ptrhash-throughput">PtrHash: Optimal Throughput</h3>

<div id="org8f2b505" class="figure">
<p><img src="/ox-hugo/query_throughput.svg" alt="a.svg" class="large" style="height:80%" />
</p>
</div>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/markdown.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom/zoom.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/plugin/notes/notes.js"></script>


<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
plugins: [RevealMarkdown, RevealZoom, RevealNotes],
width:1920, height:1080, margin: 0.04, minScale:0.2, maxScale:2.5, disableLayout:false, transition:'none', slideNumber:'c/t', controls:false, hash:true, center:false, navigationMode:'linear', hideCursorTime:2000
});

</script>
</body>
</html>
